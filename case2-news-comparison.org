* 분석 사례 2: (개신교) 언론에 따른 어휘 체계 비교

** 데이터 개요

웹사이트에 기사를 게제하는 인터넷 언론사들의 기사를 수집.

 - [[http://www.christiantoday.co.kr/archives/page1.htm][크리스천투데이]]
 - [[http://www.newsnjoy.or.kr/news/articleList.html?page=1&view_type=tm][뉴스앤조이]]


** 데이터 수집

각 데이터를 수집하기 위해, 웹 문서 수집기를 작성하여 자동으로 웹 문서를 수집


** 전처리

분석 사례 1과 동일


** 텍스트 마이닝 기법 적용

 - 분석 사례 1과 동일하게 Word2Vec을 사용하여 단어 공간 벡터 구성
 - 데이터가 커서 t-SNE를 사용하여 전체 단어를 평면에 그려도 눈으로 식별이 어려움
 - 유사 키워드, 클러스터링 등의 결과만 탐색


** 기초 통계

문서(기사) 수

 - 크리스천투데이: 기사 133,183건
 - 뉴스앤조이: 기사 47,253건


분석에 사용된 문장 수:

(크리스천투데이 기사는, 전처리를 시간 안에 마무리하지 못하여 약 30% 정도의 분량만 가지고 분석을 진행함.)

#+BEGIN_SRC sh
  wc -l outputs/sermon-chtoday2-corpus.txt
  wc -l outputs/sermon-newsnjoy-corpus.txt
#+END_SRC

#+RESULTS:
| 3857610 | outputs/sermon-chtoday2-corpus.txt |
| 2208627 | outputs/sermon-newsnjoy-corpus.txt |

 - 크리스천투데이: 3,857,610 문장
 - 뉴스앤조이: 2,208,627 문장


#+BEGIN_SRC ipython :session :results output :exports both
  import os
  from nltk import Text

  def get_text(dataset):
      with open(os.path.join('outputs', 'sermon-{}-corpus.txt'.format(dataset))) as fin:
          for line in fin:
              words = line.split()
              for word in words:
                  yield word

  # corpus_chtoday = Text(get_text('chtoday'))
  # print(len(set(corpus_chtoday.tokens)))

  corpus_chtoday = Text(get_text('chtoday2'))
  print(len(set(corpus_chtoday.tokens)))

  corpus_newsnjoy = Text(get_text('newsnjoy'))
  print(len(set(corpus_newsnjoy.tokens)))
#+END_SRC

#+RESULTS:
: 451014
: 625501
625501

분석에 사용된 unique한 단어 수:

 - 크리스천투데이: 단어
 - 뉴스앤조이: 625,501 단어


빈도 상위 20개 단어

#+BEGIN_SRC ipython :session :results raw :exports both :ipyfile assets/chtoday-words-freq-dist.png
  %matplotlib inline
  import matplotlib
  import matplotlib.pyplot as plt
  import matplotlib.font_manager as fm

  matplotlib.rc('font', family='Noto Sans CJK KR')

  plt.figure(figsize=(10, 5))
  corpus_chtoday.plot(20)
#+END_SRC


#+BEGIN_SRC ipython :session :results raw :exports both :ipyfile assets/newsnjoy-words-freq-dist.png
  plt.figure(figsize=(10, 5))
  corpus_newsnjoy.plot(20)
#+END_SRC

#+RESULTS:
# Out[23]:
[[file:assets/newsnjoy-words-freq-dist.png]]
** 1차 시각화 결과




뉴스앤조이

2글자 이상인 단어만 시각화하여, 2,441 단어 시각화

[[./assets/newsnjoy-tsne.png]]



** 유사어 관계

#+BEGIN_SRC ipython :session :results raw output :exports both
from kasr.sermons.core import SermonVoca
voca_newsnjoy = SermonVoca('newsnjoy')
voca_newsnjoy.load()
#+END_SRC


#+BEGIN_SRC ipython :session :results raw :exports both
voca_newsnjoy.most_similar(positive=['목사/N'])
#+END_SRC

#+RESULTS:
# Out[30]:
#+BEGIN_EXAMPLE
  [('장/N', 0.7498142123222351),
  ('회장/N', 0.7370667457580566),
  ('총무/N', 0.7154875993728638),
  ('전도사/N', 0.7130184173583984),
  ('총회장/N', 0.7127476930618286),
  ('위원장/N', 0.698717474937439),
  ('집사/N', 0.6957390308380127),
  ('담임목사/N', 0.6939536333084106),
  ('장로/N', 0.692682147026062),
  ('예장통합/N', 0.6907239556312561)]
#+END_EXAMPLE


#+BEGIN_SRC ipython :session :results raw :exports both
voca_newsnjoy.most_similar(positive=['교회/N'])
#+END_SRC

#+RESULTS:
# Out[31]:
#+BEGIN_EXAMPLE
  [('교회들/N', 0.7142208814620972),
  ('대형교회/N', 0.6796846389770508),
  ('개교회/N', 0.6579814553260803),
  ('한국교회/N', 0.6391738653182983),
  ('사랑의교회/N', 0.603264331817627),
  ('교인/N', 0.6005311012268066),
  ('성도들/N', 0.5958287715911865),
  ('목회자/N', 0.5922025442123413),
  ('교회당/N', 0.5798037648200989),
  ('담임목사/N', 0.5715576410293579)]
#+END_EXAMPLE


#+BEGIN_SRC ipython :session :results raw :exports both
voca_newsnjoy.most_similar(positive=['가족/N'])
#+END_SRC

#+RESULTS:
# Out[32]:
#+BEGIN_EXAMPLE
  [('가족들/N', 0.7825369834899902),
  ('가정/N', 0.6989453434944153),
  ('부부/N', 0.6772315502166748),
  ('친구/N', 0.6121994256973267),
  ('자녀들/N', 0.595382571220398),
  ('남편/N', 0.5857027769088745),
  ('집/N', 0.5848739147186279),
  ('아내/N', 0.5830844640731812),
  ('동생/N', 0.5793147087097168),
  ('형제/N', 0.5695849657058716)]
#+END_EXAMPLE


#+BEGIN_SRC ipython :session :results raw :exports both
voca_newsnjoy.most_similar(positive=['가정/N'])
#+END_SRC

#+RESULTS:
# Out[33]:
#+BEGIN_EXAMPLE
  [('가족/N', 0.6989452838897705),
  ('부부/N', 0.6796683073043823),
  ('자녀들/N', 0.652302622795105),
  ('직장/N', 0.5992605686187744),
  ('자녀/N', 0.5903303623199463),
  ('부모/N', 0.5884583592414856),
  ('입양/N', 0.5744744539260864),
  ('돌보/P', 0.5665442943572998),
  ('이혼/N', 0.5603397488594055),
  ('집안/N', 0.5600519180297852)]
#+END_EXAMPLE


#+BEGIN_SRC ipython :session :results raw :exports both
voca_newsnjoy.most_similar(positive=['가정/N', '이혼/N'], negative=['교회/N'])
#+END_SRC

#+RESULTS:
# Out[34]:
#+BEGIN_EXAMPLE
  [('결혼/N', 0.6791743040084839),
  ('부모/N', 0.5942655801773071),
  ('부부/N', 0.5693789720535278),
  ('낳/P', 0.5443986654281616),
  ('남편/N', 0.5420006513595581),
  ('입양/N', 0.5286469459533691),
  ('자살/N', 0.48497599363327026),
  ('가족/N', 0.4798312783241272),
  ('아내/N', 0.47673484683036804),
  ('아이/N', 0.4701811671257019)]
#+END_EXAMPLE


** 클러스터링


뉴스앤조이

[[./assets/newsnjoy_dendrogram.png]]


#+BEGIN_SRC ipython :session :results raw output :exports both
from scipy.cluster.hierarchy import linkage, fcluster

l = linkage(voca_newsnjoy.model.wv.vectors, method='complete', metric='seuclidean')
cluster_vector_newsnjoy = fcluster(l, 17, 'distance')
print(len(set(cluster_vector_newsnjoy)))
#+END_SRC

#+RESULTS:
97

17 레벨에서 cut하면 97개의 클러스터가 나옴.

#+BEGIN_SRC ipython :session :results raw output :exports both
  def cluster_words(cluster_number, cluster_vector, word_vector):
      words = []
      for index, cluster in enumerate(cluster_vector):
          if cluster == cluster_number:
              words.append(word_vector[index])
      return words
#+END_SRC


#+BEGIN_SRC ipython :session :results output :exports both
  for cluster in range(1, 20):
      words = cluster_words(cluster, cluster_vector_newsnjoy, voca_newsnjoy.model.wv.index2word)
      print('{} ({})'.format(cluster, len(words)), words)
#+END_SRC

#+RESULTS:
#+begin_example
1 (5) ['재정/N', '예산/N', '집행/N', '투명/N', '투명성/N']
2 (9) ['반대/N', '개정/N', '통과/N', '찬성/N', '폐/N', '사학법/N', '사학/N', '개정안/N', '폐지/N']
3 (4) ['부동산/N', '토지/N', '분배/N', '불로소득/N']
4 (1) ['희년/N']
5 (19) ['성경/N', '표현/N', '해석/N', '기록/N', '본문/N', '개념/N', '번역/N', '언어/N', '단어/N', '성서/N', '구절/N', '인용/N', '비유/N', '용어/N', '복음서/N', '마태복음/N', '문장/N', '요한복음/N', '누가복음/N']
6 (36) ['복음/N', '전하/P', '죽음/N', '십자가/N', '하나님나라/N', '회복/N', '부활/N', '오직/M', '영광/N', '선포/N', '치유/N', '인류/N', '실현/N', '거룩/N', '영원/N', '십자/N', '지배/N', '다스리/P', '완성/N', '전파/N', '기원/N', '거룩한/N', '성취/N', '지배하/N', '통치/N', '구현/N', '온전히/M', '육체/N', '영원히/M', '변혁/N', '육신/N', '좇/P', '오로지/M', '종말/N', '헛되/P', '최후/N']
7 (32) ['하나/N', '문화/N', '쪽/N', '보수/N', '형성/N', '차이/N', '진보/N', '복음주의/N', '둘/N', '이슬람/N', '진영/N', '보수적/N', '문화적/N', '서구/N', '초월/N', '가르/P', '진보적/N', '좌파/N', '조화/N', '나뉘/P', '결합/N', '공존/N', '공산주의/N', '배타적/N', '다양성/N', '치우치/P', '자유주의/N', '양쪽/N', '우파/N', '노선/N', '다원주의/N', '복음주의권/N']
8 (24) ['기독교/N', '종교/N', '시대/N', '개신교/N', '등장/N', '전통/N', '인물/N', '타락/N', '가톨릭/N', '부패/N', '불교/N', '계시/N', '탄생/N', '위대한/N', '천주교/N', '장로교/N', '메시아/N', '중세/N', '시대적/N', '교파/N', '당대/N', '출현/N', '관습/N', '유교/N']
9 (7) ['구원/N', '교리/N', '지옥/N', '영생/N', '성화/N', '구원론/N', '칭의/N']
10 (13) ['창조/N', '과학/N', '지구/N', '우주/N', '형상/N', '섭리/N', '피조물/N', '만물/N', '법칙/N', '진화론/N', '진화/N', '태양/N', '이치/N']
11 (4) ['율법/N', '언약/N', '안식일/N', '계명/N']
12 (4) ['너희/N', '여호와/N', '거하/P', '여호/N']
13 (40) ['삶/N', '고통/N', '바울/N', '인생/N', '남/N', '고난/N', '깨닫/P', '용서/N', '제자들/N', '로마/N', '자랑/N', '부끄럽/P', '여인/N', '제자/N', '시험/N', '베드/N', '평생/N', '사탄/N', '유혹/N', '겸손/N', '교황/N', '죄인/N', '마리아/N', '시인/N', '칭찬/N', '초대교회/N', '요한/N', '돌이키/P', '핍박/N', '교만/N', '스승/N', '사도/N', '마귀/N', '생애/N', '생/N', '충고/N', '요하/P', '책망/N', '용/N', '일생/N']
14 (15) ['너/N', '마/N', '고/M', '아니하/P', '마르/P', '형제/N', '고전/N', '요/M', '것이요/N', '눅/N', '롬/N', '행/N', '목마르/P', '나그네/N', '배고프/P']
15 (19) ['조사/N', '판결/N', '재판/N', '혐의/N', '소송/N', '검찰/N', '법원/N', '고소/N', '고발/N', '전병욱/N', '재판국/N', '처분/N', '검사/N', '정지/N', '기소/N', '광성교회/N', '면직/N', '제명/N', '이성곤/N']
16 (3) ['무르/P', '임기/N', '정년/N']
17 (36) ['총회/N', '결정/N', '후보/N', '총장/N', '노회/N', '선거/N', '이사장/N', '당회/N', '결의/N', '이사/N', '회의/N', '이사회/N', '절차/N', '처리/N', '표/N', '자격/N', '투표/N', '회원/N', '총대들/N', '뽑/P', '공동의회/N', '임원회/N', '사항/N', '보고/N', '당선/N', '임원/N', '회원들/N', '본부/N', '노회장/N', '당회장/N', '임명/N', '위원/N', '교육부/N', '제직회/N', '시무/N', '결정한/N']
18 (7) ['동성애/N', '결혼/N', '낳/P', '자살/N', '이혼/N', '입양/N', '에이즈/N']
19 (91) ['사람/N', '사람들/N', '한국/N', '미국/N', '어렵/P', '학교/N', '교육/N', '사역/N', '돕/P', '생활/N', '힘들/P', '지원/N', '학생들/N', '현장/N', '배우/P', '공부/N', '가족/N', '선교사/N', '가정/N', '일본/N', '도움/N', '대학/N', '부모/N', '학생/N', '한국의/N', '훈련/N', '주변/N', '환경/N', '중국/N', '교사/N', '청년/N', '젊/P', '신학교/N', '보호/N', '주민들/N', '돌보/P', '가족들/N', '누군가/N', '부부/N', '국내/N', '전도사/N', '선생님/N', '부담/N', '외국/N', '일상/N', '선생/N', '졸업/N', '신앙생활/N', '현지/N', '간사/N', '선교사들/N', '직장/N', '영국/N', '청소년/N', '사역자/N', '상담/N', '나이/N', '총신대/N', '해외/N', '형편/N', '수업/N', '한국인/N', '유럽/N', '팀/N', '직업/N', '어린이/N', '사정/N', '주위/N', '대원/N', '청소년들/N', '입학/N', '오가/P', '초등학교/N', '아시아/N', '고등학교/N', '어린이들/N', '양육/N', '대학생/N', '적응/N', '선교단체/N', '부모들/N', '교장/N', '학원/N', '러시아/N', '곤란/N', '중학교/N', '초반/N', '여건/N', '한국에서/N', '30대/N', '몽골/N']
#+end_example
